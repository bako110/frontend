<!-- Slogan + recherche -->
<div class="container">
  <div class="hero">
    <div class="hero-left">
      <div class="marquee-container" aria-label="Slogan du site">
        <h1 class="marquee-text">
          PRENEZ RENDEZ-VOUS AVEC UN MÉDECIN EN QUELQUES CLICS
        </h1>
      </div>

      <div class="search-container">
        <div class="search-wrapper">
          <input
            type="text"
            class="search-input"
            placeholder="Nom, Spécialité..."
            [(ngModel)]="query"
            (ngModelChange)="onAutocompleteInput($event)"
            aria-label="Recherche médecin par nom ou spécialité"
            autocomplete="off"
            aria-autocomplete="list"
            aria-haspopup="listbox"
            [attr.aria-expanded]="medecins.length > 0"
            aria-owns="suggestions-list"
          />
          <button
            class="search-btn"
            (click)="onSearch()"
            aria-label="Lancer la recherche"
            title="Lancer la recherche"
          >
            <i class="fas fa-search" aria-hidden="true"></i>
          </button>
        </div>

        <!-- Suggestions -->
        <ul
          *ngIf="suggestions.length > 0"
          id="suggestions-list"
          class="autocomplete-suggestions"
          role="listbox"
        >
          <li
            *ngFor="let suggestion of suggestions; let i = index"
            role="option"
            tabindex="0"
            (click)="onSearchByLetter(suggestion)"
            (keydown.enter)="onSearchByLetter(suggestion)"
            [class.active]="i === activeSuggestionIndex"
            [attr.aria-selected]="i === activeSuggestionIndex"
          >
            {{ suggestion }}
          </li>
        </ul>
      </div>

      <!-- Résultats recherche -->
      <div
        *ngIf="medecins.length > 0"
        class="search-results"
        role="region"
        aria-live="polite"
      >
        <h2 class="sr-only">Liste des médecins trouvés</h2>
        <div class="results-container">
          <ul class="results-list" role="list">
            <li
              *ngFor="let medecin of medecins; let i = index"
              class="medecin-card"
              [class.featured]="i < 2"
              role="listitem"
            >
              <div class="medecin-image-container">
                <button
                  class="btn-details"
                  (click)="redirectToDetail(medecin._id)"
                  (mouseenter)="hoverStates[i] = true"
                  (mouseleave)="hoverStates[i] = false"
                  [style.background-color]="hoverStates[i] ? '#0056b3' : '#007bff'"
                  [attr.aria-label]="'Voir plus d\'informations sur ' + medecin.nom"
                >
                  Voir plus
                </button>

                <img
                  *ngIf="medecin.photo"
                  [src]="medecin.photo.startsWith('data:image') ? medecin.photo : 'https://sanordv.onrender.com/' + medecin.photo"
                  [alt]="'Photo du Dr ' + medecin.nom"
                  class="medecin-avatar"
                  loading="lazy"
                />
              </div>

              <div class="medecin-info">
                <h3 class="medecin-name">{{ medecin.nom }} {{ medecin.prenom }}</h3>
                <p class="medecin-specialty">{{ medecin.specialite }}</p>
                <p class="medecin-location">
                  <i class="bi bi-geo-alt" aria-hidden="true"></i> 
                  {{ medecin.localite }}
                </p>
              </div>
            </li>
          </ul>
        </div>
      </div>

      <!-- Aucun résultat -->
      <div
        *ngIf="medecins.length === 0 && query.trim() !== ''"
        class="no-results"
        role="alert"
        aria-live="polite"
      >
        Aucun médecin trouvé pour "{{ query }}"
      </div>
    </div>

    <div class="hero-right">
      <img 
        src="assets/infirmière.png" 
        alt="Infirmière souriante" 
        loading="lazy"
      />
    </div>
  </div>
</div>

<!-- Section POURQUOI -->
<section class="section-pourquoi" aria-labelledby="pourquoi-titre">
  <div class="container">
    <h2 id="pourquoi-titre" class="section-title">POURQUOI CHOISIR SANORDV ?</h2>
    
    <div class="benefits-grid">
      <div class="benefit-card">
        <div class="benefit-icon">
          <i class="fa-solid fa-stethoscope" aria-hidden="true"></i>
        </div>
        <h3 class="benefit-title">FACILITEZ VOTRE SANTÉ</h3>
        <div class="benefit-description">
          <p>
            Prenez rendez-vous rapidement avec des médecins et spécialistes
            près de chez vous.
          </p>
          <p>
            Une plateforme simple, fiable et sécurisée pour gérer vos
            consultations en toute sérénité.
          </p>
        </div>
      </div>

      <div class="benefit-card">
        <div class="benefit-icon">
          <i class="bi bi-tools" aria-hidden="true"></i>
        </div>
        <h3 class="benefit-title">PRISE DE RENDEZ-VOUS SIMPLIFIÉE</h3>
        <div class="benefit-description">
          <p>
            Une solution tout-en-un pour patients et professionnels : trouvez
            un praticien, gérez vos agendas, et suivez vos consultations, le
            tout en ligne et en toute sécurité.
          </p>
        </div>
      </div>

      <div class="benefit-card">
        <div class="benefit-icon">
          <i class="bi bi-heart-pulse-fill" aria-hidden="true"></i>
        </div>
        <h3 class="benefit-title">ON S'OCCUPE DU RESTE</h3>
        <div class="benefit-description">
          <p>
            Prenez soin de vous. On gère vos rendez-vous, rappels, et accès
            aux praticiens facilement, en ligne.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Section Médecins -->
<section class="section-medecins" aria-labelledby="medecins-titre">
  <div class="container">
    <h2 id="medecins-titre" class="section-title">NOS MÉDECINS</h2>

    <div class="carousel-controls">
      <button 
        class="carousel-btn prev" 
        id="prevBtn"
        aria-label="Précédent"
      >
        <i class="bi bi-chevron-left" aria-hidden="true"></i>
      </button>

      <button 
        class="carousel-btn next" 
        id="nextBtn"
        aria-label="Suivant"
      >
        <i class="bi bi-chevron-right" aria-hidden="true"></i>
      </button>
    </div>

    <!-- Carousel médecins -->
    <div class="carousel-container">
      <div
        class="carousel-track"
        #carouselContainer
        tabindex="0"
        role="region"
        aria-label="Carrousel de médecins"
      >
        <div
          *ngFor="let medecin of featuredMedecins"
          class="medecin-card"
          role="group"
          aria-label="Médecin {{ medecin.prenom }} {{ medecin.nom }}"
        >
          <img
            [src]="medecin.photo ? medecin.photo : 'assets/default-avatar.png'"
            [alt]="'Photo du Dr ' + medecin.prenom + ' ' + medecin.nom"
            class="medecin-photo"
            loading="lazy"
          />

          <div class="medecin-details">
            <h3 class="medecin-name">
              Dr {{ medecin.prenom }} {{ medecin.nom }}
            </h3>
            <p class="medecin-specialty">{{ medecin.specialite }}</p>
            <p class="medecin-location">{{ medecin.localite }}</p>
            <button 
              (click)="redirectToDetail(medecin.id)" 
              class="btn-more-info"
              aria-label="Plus d'informations sur le Dr {{ medecin.prenom }} {{ medecin.nom }}"
            >
              Plus d'infos
            </button>
          </div>
        </div>

        <!-- Aucun médecin -->
        <div
          *ngIf="featuredMedecins.length === 0 && !loadingMedecins"
          class="no-medecins"
          role="alert"
        >
          {{ errorMessage || "Aucun médecin disponible pour le moment." }}
        </div>

        <!-- Chargement -->
        <div *ngIf="loadingMedecins" class="loading-spinner">
          <div class="spinner" role="status">
            <span class="sr-only">Chargement en cours...</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>